# DINOv3 Image Search App Summary

This application provides a Gradio-based web interface for performing image-to-image similarity searches using the DINOv3 model.

## Core Components

### 1. Model & Feature Extraction
- **Model**: `facebook/dinov3-vith16plus-pretrain-lvd1689m`.
- **Processor**: `AutoImageProcessor` for standardizing input images.
- **Embedding**: Extracts the `pooler_output` (840M parameters) representing the global image features.

### 2. Search Engine
- **Data Source**: `embeddings.csv` (generated by `generate_embeddings.py`).
- **Metric**: Cosine Similarity.
- **Optimization**: 
    - Embeddings are pre-loaded into a Torch tensor.
    - Stored embeddings and query embeddings are normalized ($L2$) to simplify similarity calculation to a dot product.
    - GPU acceleration is used if CUDA is available.

### 3. Gradio Interface
- **Input**: `gr.Image` (PIL type) for user uploads.
- **Output**: `gr.Gallery` displaying the top 10 results with their similarity scores.
- **Workflow**: Upload -> Preprocess -> Inference -> Tensor Matching -> Gallery Display.

## Technical Notes
- **Precision**: Uses `torch.bfloat16` for model inference to optimize VRAM usage on compatible GPUs (like the RTX 4080).
- **Paths**: Resolves image paths relative to the project root as stored in the CSV.
- **Compatibility**: Console output is sanitized of non-GBK characters for Windows stability.

## Usage
Run the app using the local virtual environment:
```powershell
.\.venv3.12\Scripts\python.exe app.py
```
